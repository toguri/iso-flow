# GitHub Actions Workflows

このディレクトリには、iso-flowプロジェクトのCI/CDワークフローが含まれています。

## 統合CI (unified-ci.yml) 

すべてのPull Requestで実行される統合CIワークフローです。PRのタイプに応じて必要なチェックのみを実行します。

### PRタイプ別の動作

| PRタイプ | プレフィックス | 実行されるチェック |
|---------|--------------|------------------|
| リバート | `revert:`, `chore:.*revert` | 共通チェックのみ |
| ドキュメント | `docs:` | 共通チェック + ドキュメントビルド |
| CI/CD | `ci:`, `chore:.*ci` | 共通チェック + 基本テスト |
| コード変更 | `feat:`, `fix:`, `refactor:`, `test:` | フルチェック |
| その他 | - | ファイル変更に基づいて自動判定 |

### チェック内容

- **共通チェック**: コミットメッセージ検証、PRフォーマット検証、自動ラベル付け
- **Rustチェック**: フォーマット、Clippy、テスト実行
- **セキュリティ監査**: cargo-auditによる依存関係の脆弱性チェック
- **ドキュメント**: cargo docによるドキュメントビルド
- **カバレッジ**: テストカバレッジの計測とCodecovへのアップロード

## マージ後の品質保証ワークフロー

PRがmainブランチにマージされた後に実行されるワークフローです：

- **rust-ci.yml**: マージ後の品質確認（フルテスト実行）
- **coverage.yml**: カバレッジトレンドの追跡
- **docs.yml**: ドキュメントの自動生成
- **gh-pages.yml**: 生成されたドキュメントをGitHub Pagesにデプロイ
- **pages-root.yml**: プロジェクトサイトの更新

### 廃止されたワークフロー

- **pr-check.yml**: unified-ci.ymlに統合されました（PR時のチェック）

## ブランチ保護ルール

mainブランチは以下のルールで保護されています：

- Pull Request必須（直接プッシュ禁止）
- 1人以上の承認が必要
- ステータスチェック必須: `Final Status Check (Unified CI)`
- 管理者も保護ルールに従う

詳細は[BRANCH_PROTECTION.md](../BRANCH_PROTECTION.md)を参照してください。

## ワークフローの設計思想

1. **PR時**: 必要最小限のチェックで素早くフィードバック
2. **マージ後**: 完全な品質保証とドキュメント生成
3. **効率性**: PRタイプに応じて不要なチェックはスキップ
4. **透明性**: すべての動作がログで確認可能